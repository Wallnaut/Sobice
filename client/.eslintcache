[{"G:\\NBP\\Sobice\\client\\src\\index.jsx":"1","G:\\NBP\\Sobice\\client\\src\\App.jsx":"2","G:\\NBP\\Sobice\\client\\src\\utils.js":"3","G:\\NBP\\Sobice\\client\\src\\state.js":"4","G:\\NBP\\Sobice\\client\\src\\api.js":"5","G:\\NBP\\Sobice\\client\\src\\hooks.js":"6","G:\\NBP\\Sobice\\client\\src\\components\\LoadingScreen.jsx":"7","G:\\NBP\\Sobice\\client\\src\\components\\Login\\index.jsx":"8","G:\\NBP\\Sobice\\client\\src\\components\\Chat\\index.jsx":"9","G:\\NBP\\Sobice\\client\\src\\components\\Chat\\use-chat-handlers.js":"10","G:\\NBP\\Sobice\\client\\src\\components\\Logo.jsx":"11","G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\TypingArea.jsx":"12","G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\MessageList\\index.jsx":"13","G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\ChatList\\index.jsx":"14","G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\ChatList\\components\\Footer.jsx":"15","G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\MessageList\\components\\SenderMessage.jsx":"16","G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\MessageList\\components\\ReceiverMessage.jsx":"17","G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\MessageList\\components\\NoMessages.jsx":"18","G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\MessageList\\components\\MessagesLoading.jsx":"19","G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\MessageList\\components\\InfoMessage.jsx":"20","G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\ChatList\\components\\ChatListItem\\index.jsx":"21","G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\ChatList\\components\\AvatarImage.jsx":"22","G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\OnlineIndicator.jsx":"23","G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\MessageList\\components\\ClockIcon.jsx":"24","G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\ChatList\\components\\ChatIcon.jsx":"25"},{"size":307,"mtime":1633863943160,"results":"26","hashOfConfig":"27"},{"size":4595,"mtime":1633866493028,"results":"28","hashOfConfig":"27"},{"size":1630,"mtime":1633863943160,"results":"29","hashOfConfig":"27"},{"size":4080,"mtime":1633863943160,"results":"30","hashOfConfig":"27"},{"size":2360,"mtime":1633866493028,"results":"31","hashOfConfig":"27"},{"size":4226,"mtime":1633863943160,"results":"32","hashOfConfig":"27"},{"size":262,"mtime":1633863943144,"results":"33","hashOfConfig":"27"},{"size":5976,"mtime":1633875996402,"results":"34","hashOfConfig":"27"},{"size":2147,"mtime":1633863943144,"results":"35","hashOfConfig":"27"},{"size":3598,"mtime":1633863943144,"results":"36","hashOfConfig":"27"},{"size":2276,"mtime":1633875329323,"results":"37","hashOfConfig":"27"},{"size":1009,"mtime":1633863943144,"results":"38","hashOfConfig":"27"},{"size":2812,"mtime":1633863943144,"results":"39","hashOfConfig":"27"},{"size":1647,"mtime":1633880560144,"results":"40","hashOfConfig":"27"},{"size":1594,"mtime":1633863943144,"results":"41","hashOfConfig":"27"},{"size":1378,"mtime":1633863943144,"results":"42","hashOfConfig":"27"},{"size":986,"mtime":1633863943144,"results":"43","hashOfConfig":"27"},{"size":371,"mtime":1633863943144,"results":"44","hashOfConfig":"27"},{"size":388,"mtime":1633863943144,"results":"45","hashOfConfig":"27"},{"size":270,"mtime":1633863943144,"results":"46","hashOfConfig":"27"},{"size":3365,"mtime":1633875433928,"results":"47","hashOfConfig":"27"},{"size":1091,"mtime":1633875511277,"results":"48","hashOfConfig":"27"},{"size":317,"mtime":1633863943144,"results":"49","hashOfConfig":"27"},{"size":474,"mtime":1633863943144,"results":"50","hashOfConfig":"27"},{"size":1126,"mtime":1633863943144,"results":"51","hashOfConfig":"27"},{"filePath":"52","messages":"53","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"198x64c",{"filePath":"54","messages":"55","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"56","messages":"57","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"58","messages":"59","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"60","messages":"61","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"62","messages":"63","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"64","messages":"65","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"66","messages":"67","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"68","messages":"69","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"70","messages":"71","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"72","messages":"73","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"74","messages":"75","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"76","messages":"77","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"78","messages":"79","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"80","messages":"81","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"82","messages":"83","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"84","messages":"85","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"86","messages":"87","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"88","messages":"89","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"90","messages":"91","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"92","messages":"93","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"94"},{"filePath":"95","messages":"96","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"97","messages":"98","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"99","messages":"100","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"101","messages":"102","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"G:\\NBP\\Sobice\\client\\src\\index.jsx",[],"G:\\NBP\\Sobice\\client\\src\\App.jsx",[],"G:\\NBP\\Sobice\\client\\src\\utils.js",[],"G:\\NBP\\Sobice\\client\\src\\state.js",[],"G:\\NBP\\Sobice\\client\\src\\api.js",[],"G:\\NBP\\Sobice\\client\\src\\hooks.js",[],"G:\\NBP\\Sobice\\client\\src\\components\\LoadingScreen.jsx",[],"G:\\NBP\\Sobice\\client\\src\\components\\Login\\index.jsx",[],"G:\\NBP\\Sobice\\client\\src\\components\\Chat\\index.jsx",[],"G:\\NBP\\Sobice\\client\\src\\components\\Chat\\use-chat-handlers.js",[],"G:\\NBP\\Sobice\\client\\src\\components\\Logo.jsx",[],"G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\TypingArea.jsx",[],"G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\MessageList\\index.jsx",[],"G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\ChatList\\index.jsx",[],"G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\ChatList\\components\\Footer.jsx",[],"G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\MessageList\\components\\SenderMessage.jsx",[],"G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\MessageList\\components\\ReceiverMessage.jsx",[],"G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\MessageList\\components\\NoMessages.jsx",[],"G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\MessageList\\components\\MessagesLoading.jsx",[],"G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\MessageList\\components\\InfoMessage.jsx",[],"G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\ChatList\\components\\ChatListItem\\index.jsx",["103","104"],"// @ts-check\r\nimport \"./style.css\";\r\nimport React, { useMemo } from \"react\";\r\nimport { useAppState } from \"../../../../../../state\";\r\nimport moment from \"moment\";\r\nimport { useEffect } from \"react\";\r\nimport { getMessages } from \"../../../../../../api\";\r\n//import AvatarImage from \"../AvatarImage\";\r\nimport OnlineIndicator from \"../../../OnlineIndicator\";\r\n\r\n/**\r\n * @param {{ active: boolean; room: import('../../../../../../state').Room; onClick: () => void; }} props\r\n */\r\nconst ChatListItem = ({ room, active = false, onClick }) => {\r\n  const { online, name, lastMessage, userId } = useChatListItemHandlers(room);\r\n  return (\r\n    <div\r\n      onClick={onClick}\r\n      className={`chat-list-item d-flex align-items-start rounded ${\r\n        active ? \"bg-white\" : \"\"\r\n      }`}\r\n    >\r\n      <div className=\"align-self-center mr-3\">\r\n        <OnlineIndicator online={online} hide={room.id === \"0\"} />\r\n      </div>\r\n      <div className=\"media-body overflow-hidden\">\r\n        <h5 className=\"text-truncate font-size-14 mb-1\">{name}</h5>\r\n        {lastMessage && (\r\n          <p className=\"text-truncate mb-0\"> {lastMessage.message} </p>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst useChatListItemHandlers = (\r\n  /** @type {import(\"../../../../../../state\").Room} */ room\r\n) => {\r\n  const { id, name } = room;\r\n  const [state] = useAppState();\r\n\r\n  /** Here we want to associate the room with a user by its name (since it's unique). */\r\n  const [isUser, online, userId] = useMemo(() => {\r\n    try {\r\n      let pseudoUserId = Math.abs(parseInt(id.split(\":\").reverse().pop()));\r\n      const isUser = pseudoUserId > 0;\r\n      const usersFiltered = Object.entries(state.users)\r\n        .filter(([, user]) => user.username === name)\r\n        .map(([, user]) => user);\r\n      let online = false;\r\n      if (usersFiltered.length > 0) {\r\n        online = usersFiltered[0].online;\r\n        pseudoUserId = +usersFiltered[0].id;\r\n      }\r\n      return [isUser, online, pseudoUserId];\r\n    } catch (_) {\r\n      return [false, false, \"0\"];\r\n    }\r\n  }, [id, name, state.users]);\r\n\r\n  const lastMessage = useLastMessage(room);\r\n\r\n  return {\r\n    isUser,\r\n    online,\r\n    userId,\r\n    name: room.name,\r\n    lastMessage,\r\n  };\r\n};\r\n\r\nconst useLastMessage = (\r\n  /** @type {import(\"../../../../../../state\").Room} */ room\r\n) => {\r\n  const [, dispatch] = useAppState();\r\n  const { lastMessage } = room;\r\n  useEffect(() => {\r\n    if (lastMessage === undefined) {\r\n      /** need to fetch it */\r\n      if (room.messages === undefined) {\r\n        getMessages(room.id, 0, 1).then((messages) => {\r\n          let message = null;\r\n          if (messages.length !== 0) {\r\n            message = messages.pop();\r\n          }\r\n          dispatch({\r\n            type: \"set last message\",\r\n            payload: { id: room.id, lastMessage: message },\r\n          });\r\n        });\r\n      } else if (room.messages.length === 0) {\r\n        dispatch({\r\n          type: \"set last message\",\r\n          payload: { id: room.id, lastMessage: null },\r\n        });\r\n      } else {\r\n        dispatch({\r\n          type: \"set last message\",\r\n          payload: {\r\n            id: room.id,\r\n            lastMessage: room.messages[room.messages.length - 1],\r\n          },\r\n        });\r\n      }\r\n    }\r\n  }, [lastMessage, dispatch, room]);\r\n\r\n  return lastMessage;\r\n};\r\n\r\nexport default ChatListItem;\r\n","G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\ChatList\\components\\AvatarImage.jsx",[],"G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\OnlineIndicator.jsx",[],"G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\MessageList\\components\\ClockIcon.jsx",[],"G:\\NBP\\Sobice\\client\\src\\components\\Chat\\components\\ChatList\\components\\ChatIcon.jsx",[],{"ruleId":"105","severity":1,"message":"106","line":5,"column":8,"nodeType":"107","messageId":"108","endLine":5,"endColumn":14},{"ruleId":"105","severity":1,"message":"109","line":15,"column":38,"nodeType":"107","messageId":"108","endLine":15,"endColumn":44},"no-unused-vars","'moment' is defined but never used.","Identifier","unusedVar","'userId' is assigned a value but never used."]